<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰ªäÊó•„Å™„Å´„Åô„ÇãÔºü</title>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZCM130H3XQ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-ZCM130H3XQ');
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: #F49070;
            min-height: 100vh;
            width: 100%;
            color: #1A1A1A;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 20px 20px 20px 20px;
            min-height: 100vh;
        }

        /* AdSense */
        .ad-container {
            width: 100%;
            max-width: 480px;
            margin: 20px auto;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ad-container.top-ad {
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .ad-container.bottom-ad {
            margin-top: 30px;
            margin-bottom: 20px;
        }

        /* Loading */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #F49070;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-screen.hidden {
            display: none;
        }

        .loading {
            width: 56px;
            height: 56px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            margin-top: 20px;
            color: white;
            font-weight: 600;
            font-size: 1.0625rem;
        }

        .loading-subtext {
            margin-top: 8px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
            font-size: 0.875rem;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 20px;
        }

        .title-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .title-text {
            font-size: 2rem;
            font-weight: 800;
            color: white;
            line-height: 1;
        }

        .title-highlight {
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 2rem;
            font-weight: 900;
            color: #1A1A1A;
            background: #F49070;
            padding: 6px 20px;
            border-radius: 10px;
            border: 3px solid white;
            line-height: 1;
        }

        .subtitle {
            font-size: 0.9375rem;
            font-weight: 600;
            color: #1A1A1A;
            margin-bottom: 4px;
        }

        /* Card */
        .card-container {
            perspective: 1500px;
            margin-bottom: 0;
        }

        .card {
            position: relative;
            width: 100%;
            min-height: 500px;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        /* „Éë„Éº„ÉÜ„Ç£„ÇØ„É´„Ç®„Éï„Çß„ÇØ„Éà */
        .card.flipped::before,
        .card.flipped::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 10px;
            height: 10px;
            background: #F0927E;
            border-radius: 50%;
            opacity: 0;
            animation: particle 1s ease-out;
        }

        .card.flipped::before {
            animation-delay: 0.2s;
            background: #E88B77;
        }

        @keyframes particle {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translate(calc(-50% + 100px), calc(-50% - 100px)) scale(3);
            }
        }

        .card-face {
            position: absolute;
            width: 100%;
            min-height: 500px;
            background: #F5F0EB;
            border-radius: 32px;
            padding: 28px 24px 36px 24px;
            backface-visibility: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .card-back {
            transform: rotateY(180deg);
        }

        /* Filters */
        .filter-group {
            margin-bottom: 16px;
        }

        .filter-label {
            display: block;
            font-size: 1.125rem;
            font-weight: 700;
            color: #1A1A1A;
            margin-bottom: 6px;
        }

        select {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #E88B77;
            border-radius: 20px;
            font-size: 1rem;
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 500;
            color: #1A1A1A;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='14' height='9' viewBox='0 0 14 9' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L7 7L13 1' stroke='%23E88B77' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 20px center;
        }

        select:focus {
            outline: none;
            border-color: #F0927E;
            box-shadow: 0 0 0 4px rgba(240, 146, 126, 0.2);
        }

        /* Button */
        .decide-button {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 20px;
            background: #F0927E;
            color: white;
            font-size: 1.25rem;
            font-weight: 800;
            font-family: 'Noto Sans JP', sans-serif;
            cursor: pointer;
            margin-top: 8px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 6px 24px rgba(240, 146, 126, 0.4);
        }

        .decide-button:hover:not(:disabled) {
            background: #E88B77;
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(240, 146, 126, 0.5);
        }

        .decide-button:active:not(:disabled) {
            transform: translateY(0);
        }

        .decide-button:disabled {
            background: #C4B4A4;
            cursor: not-allowed;
            box-shadow: none;
            opacity: 0.6;
        }

        /* Results */
        .result-title {
            font-size: 2.5rem;
            font-weight: 900;
            color: #E88B77;
            margin-bottom: 16px;
            text-align: center;
            line-height: 1.2;
            animation: titleReveal 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) both;
        }

        @keyframes titleReveal {
            0% {
                opacity: 0;
                transform: scale(0.3) rotate(-15deg);
            }
            50% {
                transform: scale(1.1) rotate(5deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        .result-location {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1A1A1A;
            text-align: center;
            margin-bottom: 32px;
            animation: fadeInUp 0.8s ease-out 0.3s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-section {
            background: white;
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            border: 2px solid #E88B77;
            animation: slideInLeft 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) both;
            animation-delay: calc(0.5s + var(--delay, 0s));
        }

        .result-section:nth-of-type(1) {
            --delay: 0s;
        }

        .result-section:nth-of-type(2) {
            --delay: 0.15s;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        .result-section-title {
            font-size: 1rem;
            font-weight: 800;
            color: #E88B77;
            margin-bottom: 12px;
            animation: fadeIn 0.5s ease-out both;
            animation-delay: calc(0.6s + var(--delay, 0s));
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .result-section-content {
            font-size: 1.0625rem;
            line-height: 1.7;
            color: #1A1A1A;
            font-weight: 500;
            animation: fadeIn 0.5s ease-out both;
            animation-delay: calc(0.7s + var(--delay, 0s));
        }

        .tags {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 28px;
        }

        .tag {
            padding: 12px 20px;
            background: white;
            border-radius: 20px;
            font-size: 0.9375rem;
            font-weight: 700;
            color: #E88B77;
            border: 2px solid #E88B77;
            transition: all 0.3s ease;
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) both;
            animation-delay: calc(0.8s + var(--tag-delay, 0s));
        }

        .tag:nth-child(1) { --tag-delay: 0s; }
        .tag:nth-child(2) { --tag-delay: 0.1s; }
        .tag:nth-child(3) { --tag-delay: 0.2s; }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0) rotate(-180deg);
            }
            50% {
                transform: scale(1.2) rotate(10deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        .tag:hover {
            background: #E88B77;
            color: white;
            transform: translateY(-2px);
        }

        /* Action Buttons */
        .reset-button,
        .ai-search-button {
            width: 100%;
            padding: 20px;
            border-radius: 20px;
            font-size: 1.125rem;
            font-weight: 800;
            font-family: 'Noto Sans JP', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 16px;
        }

        .reset-button {
            background: white;
            border: 2px solid #E88B77;
            color: #E88B77;
            animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) 1.2s both;
        }

        .reset-button:hover {
            background: #E88B77;
            color: white;
            transform: translateY(-2px);
        }

        .ai-search-button {
            background: #F0927E;
            border: none;
            color: white;
            box-shadow: 0 6px 24px rgba(240, 146, 126, 0.4);
            animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) 1.4s both;
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3) translateY(50px);
            }
            50% {
                transform: scale(1.05) translateY(-10px);
            }
            70% {
                transform: scale(0.95) translateY(5px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .ai-search-button:hover {
            background: #E88B77;
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(240, 146, 126, 0.5);
        }

        /* Footer */
        footer {
            margin-top: 40px;
            padding: 30px 20px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
        }

        .footer-links {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .footer-link {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9375rem;
            transition: all 0.3s ease;
            padding: 8px 16px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.2);
        }

        .footer-link:hover {
            background: white;
            color: #F49070;
            transform: translateY(-2px);
        }

        .copyright {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.875rem;
            margin-top: 15px;
        }

        /* Responsive */
        @media (max-width: 420px) {
            .title-text,
            .title-highlight {
                font-size: 1.75rem;
            }
            
            .card-face {
                padding: 24px 20px 32px 20px;
                min-height: 480px;
            }

            .card {
                min-height: 480px;
            }
            
            .result-title {
                font-size: 2rem;
            }

            .filter-group {
                margin-bottom: 14px;
            }

            .filter-label {
                font-size: 1rem;
                margin-bottom: 6px;
            }

            select {
                padding: 10px 18px;
                font-size: 0.9375rem;
            }

            .decide-button {
                padding: 12px;
                font-size: 1.125rem;
                margin-bottom: 8px;
            }

            .container {
                padding: 16px 20px 16px 20px;
            }

            header {
                margin-bottom: 16px;
            }

            .title-container {
                margin-bottom: 12px;
            }
        }

        @media (max-height: 700px) and (orientation: landscape) {
            .card-face {
                padding: 28px 24px;
                min-height: auto;
            }

            .card {
                min-height: auto;
            }

            .filter-group {
                margin-bottom: 20px;
            }

            header {
                margin-bottom: 24px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading -->
    <div class="loading-screen" id="loading-screen">
        <div class="loading"></div>
        <div class="loading-text">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
        <div class="loading-subtext">„Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£„Éá„Éº„Çø„ÇíÊ∫ñÂÇô„Åó„Å¶„ÅÑ„Åæ„Åô</div>
    </div>

    <div class="container">
        <!-- Top Ad -->
        <div class="ad-container top-ad">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-8351694040475451"
                 data-ad-slot="1234567890"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>

        <header>
            <div class="title-container">
                <span class="title-text">‰ªäÊó•„ÄÅ</span>
                <span class="title-highlight">„Å™„Å´</span>
                <span class="title-text">„Åô„ÇãÔºü</span>
            </div>
            <p class="subtitle">„ÅÇ„Å™„Åü„ÅÆÁâπÂà•„Å™‰∏ÄÊó•„ÇíË¶ã„Å§„Åë„Çà„ÅÜ</p>
        </header>

        <div class="card-container">
            <div class="card" id="main-card">
                <!-- Front Face -->
                <div class="card-face card-front">
                    <div class="filter-group">
                        <label class="filter-label">ÊôÇÈñì</label>
                        <select id="time-filter">
                            <option value="">ÊåáÂÆö„Å™„Åó</option>
                            <option value="1ÊôÇÈñì">1ÊôÇÈñì</option>
                            <option value="2ÊôÇÈñì">2ÊôÇÈñì</option>
                            <option value="ÂçäÊó•">ÂçäÊó•</option>
                            <option value="1Êó•">1Êó•</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">‰∫∫Êï∞</label>
                        <select id="people-filter">
                            <option value="">ÊåáÂÆö„Å™„Åó</option>
                            <option value="1‰∫∫">1‰∫∫</option>
                            <option value="2‰∫∫">2‰∫∫</option>
                            <option value="„Ç∞„É´„Éº„Éó">„Ç∞„É´„Éº„Éó</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Â†¥ÊâÄ</label>
                        <select id="location-filter">
                            <option value="">ÊåáÂÆö„Å™„Åó</option>
                            <option value="Êù±‰∫¨">Êù±‰∫¨</option>
                            <option value="Á•ûÂ•àÂ∑ù">Á•ûÂ•àÂ∑ù</option>
                            <option value="ÂüºÁéâ">ÂüºÁéâ</option>
                            <option value="ÂçÉËëâ">ÂçÉËëâ</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Â≠£ÁØÄ</label>
                        <select id="season-filter">
                            <option value="">ÊåáÂÆö„Å™„Åó</option>
                            <option value="Êò•">Êò•</option>
                            <option value="Â§è">Â§è</option>
                            <option value="Áßã">Áßã</option>
                            <option value="ÂÜ¨">ÂÜ¨</option>
                            <option value="ÈÄöÂπ¥">ÈÄöÂπ¥</option>
                        </select>
                    </div>

                    <button class="decide-button" id="decide-btn">Ê±∫„ÇÅ„Çã</button>
                </div>

                <!-- Back Face -->
                <div class="card-face card-back">
                    <h2 class="result-title" id="result-title"></h2>
                    <div class="result-location" id="result-location"></div>

                    <div class="result-section">
                        <div class="result-section-title">„ÇÑ„Çã„Åì„Å®</div>
                        <div class="result-section-content" id="result-activity"></div>
                    </div>

                    <div class="result-section">
                        <div class="result-section-title">„Åä„Åô„Åô„ÇÅ„Éù„Ç§„É≥„Éà</div>
                        <div class="result-section-content" id="result-point"></div>
                    </div>

                    <div class="tags" id="result-tags"></div>

                    <button class="reset-button" id="reset-btn">„ÇÇ„ÅÜ‰∏ÄÂ∫¶ÈÅ∏„Å∂</button>
                    <button class="ai-search-button" id="ai-search-btn">AI„ÅßË©≥„Åó„ÅèË™ø„Åπ„Çã</button>
                </div>
            </div>
        </div>

        <!-- Bottom Ad -->
        <div class="ad-container bottom-ad">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-8351694040475451"
                 data-ad-slot="9876543210"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>

        <!-- Footer -->
        <footer>
            <div class="footer-links">
                <a href="privacy.html" class="footer-link">„Éó„É©„Ç§„Éê„Ç∑„Éº„Éù„É™„Ç∑„Éº</a>
                <a href="contact.html" class="footer-link">„ÅäÂïè„ÅÑÂêà„Çè„Åõ</a>
            </div>
            <div class="copyright">
                ¬© 2024 ‰ªäÊó•„Å™„Å´„Åô„ÇãÔºü All Rights Reserved.
            </div>
        </footer>
    </div>

    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <script>
        // „Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£„Éá„Éº„Çø„Éô„Éº„ÇπÔºàÈùûÂêåÊúüË™≠„ÅøËæº„ÅøÔºâ
        let activities = [];

        // „Éá„Éï„Ç©„É´„Éà„Éá„Éº„ÇøÔºàJSON„Éï„Ç°„Ç§„É´„ÅåË™≠„ÅøËæº„ÇÅ„Å™„ÅÑÂ†¥Âêà„ÅÆ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÔºâ
        const defaultActivities = [
            { location: "Êù±‰∫¨", place: "ÁöáÂ±ÖÊù±Âæ°Ëãë", activity: "Ê±üÊà∏Âüé„ÅÆÊ≠¥Âè≤„ÇíÊÑü„Åò„Å™„Åå„ÇâÊï£Á≠ñ", time: "2ÊôÇÈñì", point: "ÁÑ°Êñô„ÅßÂÖ•„Çå„ÇãÊó•Êú¨Â∫≠Âúí„ÅÆÁæé„Åó„Åï", season: "ÈÄöÂπ¥", people: "1‰∫∫" },
            { location: "Êù±‰∫¨", place: "‰ª£„ÄÖÊú®ÂÖ¨Âúí", activity: "„Éî„ÇØ„Éã„ÉÉ„ÇØ", time: "ÂçäÊó•", point: "ÈÉΩ‰ºö„ÅÆ„Ç™„Ç¢„Ç∑„Çπ„ÅßËá™ÁÑ∂„ÇíÊ∫ÄÂñ´", season: "Êò•", people: "2‰∫∫" },
            { location: "Á•ûÂ•àÂ∑ù", place: "ÈéåÂÄâ", activity: "ÂØ∫Á§æÂ∑°„Çä", time: "1Êó•", point: "Ê≠¥Âè≤„Å®Ëá™ÁÑ∂„ÅåËûçÂêà„Åó„ÅüÂè§ÈÉΩ", season: "ÈÄöÂπ¥", people: "2‰∫∫" },
            { location: "Êù±‰∫¨", place: "ÊµÖËçâ", activity: "Èõ∑ÈñÄ„Åã„Çâ‰ª≤Ë¶ã‰∏ñÈÄö„Çä„ÇíÊï£Á≠ñ", time: "2ÊôÇÈñì", point: "‰∏ãÁî∫„ÅÆÈ¢®ÊÉÖ„Å®‰ºùÁµ±Â∑•Ëä∏ÂìÅ", season: "ÈÄöÂπ¥", people: "2‰∫∫" },
            { location: "Á•ûÂ•àÂ∑ù", place: "Ê±ü„ÉéÂ≥∂", activity: "Êµ∑„ÇíË¶ã„Å™„Åå„Çâ„Ç´„Éï„Çß„Åß„ÅÆ„Çì„Å≥„Çä", time: "ÂçäÊó•", point: "ÊπòÂçó„ÅÆÊµ∑È¢®„ÇíÊÑü„Åò„ÇãÁôí„Åó„Çπ„Éù„ÉÉ„Éà", season: "Â§è", people: "2‰∫∫" },
            { location: "Êù±‰∫¨", place: "‰∏äÈáéÂÖ¨Âúí", activity: "ÁæéË°ìÈ§®Â∑°„Çä", time: "ÂçäÊó•", point: "Â§öÂΩ©„Å™ÊñáÂåñÊñΩË®≠„ÅåÈõÜ„Åæ„Çã„Ç®„É™„Ç¢", season: "ÈÄöÂπ¥", people: "1‰∫∫" },
            { location: "ÂçÉËëâ", place: "Ë∞∑Ê¥•Âπ≤ÊΩü", activity: "„Éê„Éº„Éâ„Ç¶„Ç©„ÉÉ„ÉÅ„É≥„Ç∞", time: "2ÊôÇÈñì", point: "ÈÉΩ‰ºö„ÅÆËøë„Åè„ÅßÈáéÈ≥•Ë¶≥ÂØü", season: "Êò•", people: "1‰∫∫" },
            { location: "ÂüºÁéâ", place: "Â∑ùË∂ä", activity: "ËîµÈÄ†„Çä„ÅÆË°ó‰∏¶„ÅøÊï£Á≠ñ", time: "ÂçäÊó•", point: "Â∞èÊ±üÊà∏„ÅÆÈõ∞Âõ≤Ê∞ó„ÇíÊ•Ω„Åó„ÇÄ", season: "ÈÄöÂπ¥", people: "2‰∫∫" },
            { location: "Êù±‰∫¨", place: "„ÅäÂè∞Â†¥", activity: "Êµ∑ÊµúÂÖ¨Âúí„ÅßÂ§ïÊó•ÈëëË≥û", time: "2ÊôÇÈñì", point: "Êù±‰∫¨Êπæ„ÅÆÁæé„Åó„ÅÑÂ§ïÊôØ", season: "ÈÄöÂπ¥", people: "2‰∫∫" },
            { location: "Á•ûÂ•àÂ∑ù", place: "Ê®™ÊµúËµ§„É¨„É≥„Ç¨ÂÄâÂ∫´", activity: "„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞„Å®„Ç∞„É´„É°", time: "ÂçäÊó•", point: "Ê≠¥Âè≤ÁöÑÂª∫ÈÄ†Áâ©„Åß„Åä„Åó„ÇÉ„Çå„Å™ÊôÇÈñì", season: "ÈÄöÂπ¥", people: "2‰∫∫" },
            { location: "Êù±‰∫¨", place: "ÊòéÊ≤ªÁ•ûÂÆÆ", activity: "Á•ûÁ§æÂèÇÊãù„Å®Ê£ÆÊûóÊµ¥", time: "1ÊôÇÈñì", point: "ÈÉΩÂøÉ„ÅÆÈùôÂØÇ„Å™„Éë„ÉØ„Éº„Çπ„Éù„ÉÉ„Éà", season: "ÈÄöÂπ¥", people: "1‰∫∫" },
            { location: "ÂçÉËëâ", place: "ÊàøÁ∑èÂçäÂ≥∂", activity: "Êµ∑Â≤∏„Éâ„É©„Ç§„Éñ", time: "1Êó•", point: "Â§™Âπ≥Ê¥ã„ÅÆÁµ∂ÊôØ„ÇíÊ•Ω„Åó„ÇÄ", season: "Â§è", people: "2‰∫∫" },
            { location: "ÂüºÁéâ", place: "Áß©Áà∂", activity: "Ê∏©Ê≥â„Å®„Ç∞„É´„É°", time: "1Êó•", point: "Ëá™ÁÑ∂Ë±ä„Åã„Å™Áôí„Åó„ÅÆÊ∏©Ê≥âÂú∞", season: "ÂÜ¨", people: "2‰∫∫" },
            { location: "Êù±‰∫¨", place: "Êù±‰∫¨„Çø„ÉØ„Éº", activity: "Â±ïÊúõÂè∞„Åã„ÇâÂ§úÊôØÈëëË≥û", time: "2ÊôÇÈñì", point: "Êù±‰∫¨„ÅÆË±°Âæ¥„Åã„ÇâË¶ã„ÇãÁµ∂ÊôØ", season: "ÈÄöÂπ¥", people: "2‰∫∫" },
            { location: "Á•ûÂ•àÂ∑ù", place: "ÁÆ±Ê†π", activity: "ÁæéË°ìÈ§®Â∑°„Çä„Å®Ê∏©Ê≥â", time: "1Êó•", point: "„Ç¢„Éº„Éà„Å®Ëá™ÁÑ∂„ÅÆËûçÂêà", season: "ÈÄöÂπ¥", people: "2‰∫∫" }
        ];

        // „Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÈñ¢Êï∞
        async function loadActivities() {
            try {
                const response = await fetch('./activities.json');
                if (response.ok) {
                    const data = await response.json();
                    activities = data;
                    console.log(`‚úÖ ${activities.length}‰ª∂„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü`);
                } else {
                    throw new Error('JSON„Éï„Ç°„Ç§„É´„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                }
            } catch (error) {
                console.log('‚ÑπÔ∏è  activities.json„ÅåË¶ã„Å§„Åã„Çâ„Å™„ÅÑ„Åü„ÇÅ„ÄÅ„Éá„Éï„Ç©„É´„Éà„Éá„Éº„Çø„Çí‰ΩøÁî®„Åó„Åæ„Åô');
                activities = defaultActivities;
            }
        }

        // DOMË¶ÅÁ¥†
        const decideBtn = document.getElementById('decide-btn');
        const mainCard = document.getElementById('main-card');
        const resetBtn = document.getElementById('reset-btn');
        const aiSearchBtn = document.getElementById('ai-search-btn');
        const loadingScreen = document.getElementById('loading-screen');

        const timeFilter = document.getElementById('time-filter');
        const peopleFilter = document.getElementById('people-filter');
        const locationFilter = document.getElementById('location-filter');
        const seasonFilter = document.getElementById('season-filter');

        const resultTitle = document.getElementById('result-title');
        const resultLocation = document.getElementById('result-location');
        const resultActivity = document.getElementById('result-activity');
        const resultPoint = document.getElementById('result-point');
        const resultTags = document.getElementById('result-tags');

        let currentResult = null;

        // ÂàùÊúüÂåñ
        async function initialize() {
            await loadActivities();
            loadingScreen.classList.add('hidden');
        }

        // PerplexityÊ§úÁ¥¢„Éú„Çø„É≥
        aiSearchBtn.addEventListener('click', () => {
            if (!currentResult) return;

            const searchQuery = `${currentResult.place}Ôºà${currentResult.location}Ôºâ„ÅÆ„Ç¢„ÇØ„Çª„ÇπÊñπÊ≥ï„Å®„Åä„Åô„Åô„ÇÅ„Éù„Ç§„É≥„Éà`;
            const perplexityUrl = `https://www.perplexity.ai/search?q=${encodeURIComponent(searchQuery)}`;
            
            // GA4„Ç§„Éô„É≥„Éà: AIÊ§úÁ¥¢„ÇØ„É™„ÉÉ„ÇØ
            if (typeof gtag !== 'undefined') {
                gtag('event', 'ai_search_click', {
                    spot_name: currentResult.place,
                    location: currentResult.location,
                    search_query: searchQuery
                });
            }
            
            window.open(perplexityUrl, '_blank');
        });

        // Ê±∫„ÇÅ„Çã„Éú„Çø„É≥
        decideBtn.addEventListener('click', () => {
            const filters = {
                time: timeFilter.value,
                people: peopleFilter.value,
                location: locationFilter.value,
                season: seasonFilter.value
            };

            // GA4„Ç§„Éô„É≥„Éà: Ê§úÁ¥¢ÂÆüË°å
            if (typeof gtag !== 'undefined') {
                gtag('event', 'search_activity', {
                    time_filter: filters.time || 'ÊåáÂÆö„Å™„Åó',
                    people_filter: filters.people || 'ÊåáÂÆö„Å™„Åó',
                    location_filter: filters.location || 'ÊåáÂÆö„Å™„Åó',
                    season_filter: filters.season || 'ÊåáÂÆö„Å™„Åó'
                });
            }

            console.log('üîç Ê§úÁ¥¢Êù°‰ª∂:', filters);
            console.log('üìä Á∑è„Éá„Éº„ÇøÊï∞:', activities.length);

            // „Çπ„ÉÜ„ÉÉ„Éó1: „Åô„Åπ„Å¶„ÅÆÊù°‰ª∂„ÅßÂÆåÂÖ®‰∏ÄËá¥
            let filtered = activities.filter(activity => {
                return (!filters.time || activity.time === filters.time) &&
                       (!filters.people || activity.people === filters.people) &&
                       (!filters.location || activity.location === filters.location) &&
                       (!filters.season || activity.season === filters.season);
            });
            console.log('‚úÖ „Çπ„ÉÜ„ÉÉ„Éó1 (ÂÖ®Êù°‰ª∂‰∏ÄËá¥):', filtered.length, '‰ª∂');

            // „Çπ„ÉÜ„ÉÉ„Éó2: Â†¥ÊâÄ + ‰∫∫Êï∞ + Â≠£ÁØÄÔºàÊôÇÈñì„ÇíÈô§Â§ñÔºâ
            if (filtered.length === 0 && filters.time) {
                filtered = activities.filter(activity => {
                    return (!filters.people || activity.people === filters.people) &&
                           (!filters.location || activity.location === filters.location) &&
                           (!filters.season || activity.season === filters.season);
                });
                console.log('‚è±Ô∏è „Çπ„ÉÜ„ÉÉ„Éó2 (ÊôÇÈñì„ÇíÈô§Â§ñ):', filtered.length, '‰ª∂');
            }

            // „Çπ„ÉÜ„ÉÉ„Éó3: Â†¥ÊâÄ + ‰∫∫Êï∞ÔºàÂ≠£ÁØÄ„ÇíÈô§Â§ñÔºâ
            if (filtered.length === 0 && filters.season) {
                filtered = activities.filter(activity => {
                    return (!filters.people || activity.people === filters.people) &&
                           (!filters.location || activity.location === filters.location);
                });
                console.log('üå∏ „Çπ„ÉÜ„ÉÉ„Éó3 (Â≠£ÁØÄ„ÇíÈô§Â§ñ):', filtered.length, '‰ª∂');
            }

            // „Çπ„ÉÜ„ÉÉ„Éó4: Â†¥ÊâÄ„ÅÆ„Åø
            if (filtered.length === 0 && filters.location) {
                filtered = activities.filter(activity => 
                    activity.location === filters.location
                );
                console.log('üìç „Çπ„ÉÜ„ÉÉ„Éó4 (Â†¥ÊâÄ„ÅÆ„Åø):', filtered.length, '‰ª∂');
            }

            // „Çπ„ÉÜ„ÉÉ„Éó5: „Åô„Åπ„Å¶„Åã„ÇâÈÅ∏Êäû
            if (filtered.length === 0) {
                filtered = activities;
                console.log('üé≤ „Çπ„ÉÜ„ÉÉ„Éó5 (ÂÖ®„Éá„Éº„Çø):', filtered.length, '‰ª∂');
            }

            // „É©„É≥„ÉÄ„É†ÈÅ∏Êäû
            const selected = filtered[Math.floor(Math.random() * filtered.length)];
            console.log('üéØ ÈÅ∏ÊäûÁµêÊûú:', selected.place, `(${selected.location})`);
            
            // GA4„Ç§„Éô„É≥„Éà: „Çπ„Éù„ÉÉ„ÉàÈÅ∏Êäû
            if (typeof gtag !== 'undefined') {
                gtag('event', 'spot_selected', {
                    spot_name: selected.place,
                    location: selected.location,
                    activity: selected.activity,
                    time: selected.time,
                    people: selected.people,
                    season: selected.season
                });
            }
            
            displayResult(selected);

            // „Ç´„Éº„Éâ„Éï„É™„ÉÉ„Éó
            decideBtn.disabled = true;
            decideBtn.textContent = 'Ê±∫ÂÆö‰∏≠...';

            setTimeout(() => {
                mainCard.classList.add('flipped');
                decideBtn.disabled = false;
                decideBtn.textContent = 'Ê±∫„ÇÅ„Çã';
            }, 600);
        });

        // ÁµêÊûúË°®Á§∫
        function displayResult(activity) {
            currentResult = activity;
            
            resultTitle.textContent = activity.place;
            resultLocation.textContent = `üìç ${activity.location}`;
            resultActivity.textContent = activity.activity;
            resultPoint.textContent = activity.point;

            resultTags.innerHTML = `
                <span class="tag">‚è±Ô∏è ${activity.time}</span>
                <span class="tag">üë• ${activity.people}</span>
                <span class="tag">üå∏ ${activity.season}</span>
            `;
        }

        // „É™„Çª„ÉÉ„Éà
        resetBtn.addEventListener('click', () => {
            // GA4„Ç§„Éô„É≥„Éà: „ÇÇ„ÅÜ‰∏ÄÂ∫¶ÈÅ∏„Å∂
            if (typeof gtag !== 'undefined') {
                gtag('event', 'reset_click', {
                    previous_spot: currentResult ? currentResult.place : 'unknown'
                });
            }
            
            mainCard.classList.remove('flipped');
        });

        // ÂàùÊúüÂåñÂÆüË°å
        initialize();

    </script>
</body>
</html>
